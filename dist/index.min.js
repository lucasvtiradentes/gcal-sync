!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).GcalSync=t()}(this,(function(){"use strict";const e="gcal-sync",t="lucasvtiradentes/gcal-sync",i="2.1.1",o=(e,t,i)=>e.reduce(((e,o)=>{const n=o[t],s=o[i];return e[n]=s,e}),{});var n;const s=2500,r=3,a=15,c=2e3,d=10,m=6,l=2100,_=1e3,u="object"==typeof process&&(null===(n=null===process||void 0===process?void 0:process.env)||void 0===n?void 0:n.NODE_ENV),g=[{key:"today_github_added_commits",initial_value:[]},{key:"today_github_deleted_commits",initial_value:[]},{key:"last_released_version_alerted",initial_value:""},{key:"last_released_version_sent_date",initial_value:""},{key:"last_daily_email_sent_date",initial_value:""},{key:"github_commits_tracked_to_be_added_hash",initial_value:""},{key:"github_commits_tracked_to_be_deleted_hash",initial_value:""},{key:"github_commit_changes_count",initial_value:""}],h=o(g,"key","initial_value"),p=o(g,"key","key"),f="schema invalid",b="This method cannot run in non-production environments",y="github_sync";const $={tableStyle:'style="border: 1px solid #333; width: 90%"',tableRowStyle:'style="width: 100%"',tableRowColumnStyle:'style="border: 1px solid #333"'},k=e=>"date"in e?e.date:e.dateTime;function v(e){return e.commits_added.length+e.commits_deleted.length}function w(i){let o="";return o=`Hi!<br/><br/>there were ${v(i)} changes made to your google calendar:<br/>\n`,o+=function(e){const t=e.commits_added,i=e.commits_deleted,o=e=>0===e.length?"":`${e.map((e=>{const{repositoryLink:t,commitMessage:i,repositoryName:o}=e.extendedProperties.private,n=[k(e.start).split("T")[0],`<a href="${t}">${o}</a>`,`<a href="${e.htmlLink}">${i}</a>`].map((e=>`<td ${$.tableRowColumnStyle}>&nbsp;&nbsp;${e}</td>`)).join("\n");return`<tr ${$.tableRowStyle}">\n${n}\n</tr>`})).join("\n")}`,n=`<tr ${$.tableRowStyle}">\n<th ${$.tableRowColumnStyle} width="80px">date</th><th ${$.tableRowColumnStyle} width="130px">repository</th><th ${$.tableRowColumnStyle} width="auto">commit</th>\n</tr>`;let s="";return s+=t.length>0?`<br/>added commits events     : ${t.length}<br/><br/> \n <center>\n<table ${$.tableStyle}>\n${n}\n${o(t)}\n</table>\n</center>\n`:"",s+=i.length>0?`<br/>removed commits events   : ${i.length}<br/><br/> \n <center>\n<table ${$.tableStyle}>\n${n}\n${o(i)}\n</table>\n</center>\n`:"",s}(i),o+=`<br/>Regards,<br/>your <a href='https://github.com/${t}'>${e}</a> bot`,o}function S(e){return{shouldSyncGithub:e.configs[y].commits_configs.should_sync}}function x(e){const t=PropertiesService.getScriptProperties().getProperty(e);let i;try{i=JSON.parse(t)}catch(e){i=t}return i}function C(e,t){const i="string"==typeof t?t:JSON.stringify(t),o=i.length;console.log(`updating property "${e}" with size: ${o} chars`);try{PropertiesService.getScriptProperties().setProperty(e,i)}catch(t){throw console.log(`error updating property "${e}": ${t}`),t}}function P(e){const t=ScriptApp.getProjectTriggers().find((t=>t.getHandlerFunction()===e));t&&ScriptApp.deleteTrigger(t)}function D(e){MailApp.sendEmail(e)}const j=new class{constructor(){this.logs=[]}info(e,...t){u||(console.log(e,...t),this.logs.push(e))}error(e,...t){u||(console.error(e,...t),this.logs.push(e))}};function N(e,t){const i=function(e){const t=new Date;return t.setHours(t.getHours()+e),t}(t),o=60*Number(i.getHours())+Number(i.getMinutes()),n=e.split(":");return o>=60*Number(n[0])+Number(n[1])}function M(e){return{htmlLink:e.htmlLink,start:e.start,extendedProperties:{private:{repositoryLink:e.extendedProperties.private.repositoryLink,repositoryName:e.extendedProperties.private.repositoryName,commitMessage:e.extendedProperties.private.commitMessage}}}}function R(o,n){const{shouldSyncGithub:s}=S(o),r=n.commits_added.length+n.commits_deleted.length;if(s&&r>0){const e=x(p.today_github_added_commits),t=x(p.today_github_deleted_commits),i=n.commits_added.map(M),o=n.commits_deleted.map(M);C(p.today_github_added_commits,[...e,...i]),C(p.today_github_deleted_commits,[...t,...o]),j.info(`added ${r} new github items to today's stats`)}!function(o,n,s){var r;const a=o.user_email;if(o.configs.settings.per_sync_emails.email_session&&s>0){D(function(t,i){const o=w(i);return{to:t,name:`${e}`,subject:`session report - ${v(i)} modifications - ${e}`,htmlBody:o}}(a,n))}const c=N(o.configs.settings.per_day_emails.time_to_send,o.timezone_offset),d=o.today_date===x(p.last_daily_email_sent_date);if(c&&o.configs.settings.per_day_emails.email_daily_summary&&!d){C(p.last_daily_email_sent_date,o.today_date);D(function(t,i,o){const n=w(i);return{to:t,name:`${e}`,subject:`daily report for ${o} - ${v(i)} modifications - ${e}`,htmlBody:n}}(a,{commits_added:x(p.today_github_added_commits),commits_deleted:x(p.today_github_deleted_commits)},o.today_date)),C(p.today_github_added_commits,[]),C(p.today_github_deleted_commits,[]),j.info("today stats were reseted!")}const m=o.today_date===x(p.last_released_version_sent_date),l=e=>Number(e.replace("v","").split(".").join("")),_=()=>{var e;const o=UrlFetchApp.fetch(`https://api.github.com/repos/${t}/releases?per_page=1`);return null!==(e=JSON.parse(o.getContentText())[0])&&void 0!==e?e:{tag_name:i}};if(c&&o.configs.settings.per_day_emails.email_new_gcal_sync_release&&!m){C(p.last_released_version_sent_date,o.today_date);const n=_(),s=l(n.tag_name),c=l(i),d=null!==(r=x(p.last_released_version_alerted))&&void 0!==r?r:"";if(s>c&&s.toString()!=d){D(function(i,o){const n=`Hi!\n    <br/><br/>\n    a new <a href="https://github.com/${t}">${e}</a> version is available: <br/>\n    <ul>\n      <li>new version: ${o.tag_name}</li>\n      <li>published at: ${o.published_at}</li>\n      <li>details: <a href="https://github.com/${t}/releases">here</a></li>\n    </ul>\n    to update, replace the old version number in your apps scripts <a href="https://script.google.com/">gcal sync project</a> to the new version: ${o.tag_name.replace("v","")}<br/>\n    and also check if you need to change the setup code in the <a href='https://github.com/${t}#installation'>installation section</a>.\n    <br /><br />\n    Regards,\n    your <a href='https://github.com/${t}'>${e}</a> bot\n  `;return{to:i,name:`${e}`,subject:`new version [${o.tag_name}] was released - ${e}`,htmlBody:n}}(a,n)),C(p.last_released_version_alerted,s.toString())}}}(o,n,r);const{commits_added:a,commits_deleted:c,commits_tracked_to_be_added:d,commits_tracked_to_be_deleted:m}=n;return{commits_added:a.length,commits_deleted:c.length,commits_tracked_to_be_added:d.length,commits_tracked_to_be_deleted:m.length}}function T(e,t,i,o){var n,s,r;const a=[];let c=1;for(;c<=d;){const d=`https://api.github.com/search/commits?q=${`author:${e}+committer-date:${i}..${o}`}&page=${c}&sort=committer-date&per_page=100`,m={muteHttpExceptions:!0,headers:t?{Authorization:`Bearer ${t}`}:{}};let _;try{_=UrlFetchApp.fetch(d,m)}catch(e){console.log(`network error during ${i}..${o} page ${c}, returning partial results`);break}const u=null!==(n=JSON.parse(_.getContentText()))&&void 0!==n?n:{};if(200!==_.getResponseCode()){if(403===_.getResponseCode()&&(null===(s=u.message)||void 0===s?void 0:s.includes("rate limit"))){console.log(`GitHub rate limit hit during ${i}..${o}`);break}break}const g=null!==(r=u.items)&&void 0!==r?r:[];if(0===g.length)break;if(a.push(...g),g.length<100)break;Utilities.sleep(l),c++}return a}function G(e,t){const i=[],o=function(e=m){const t=[],i=new Date;for(let o=0;o<e;o++){const e=new Date(i.getFullYear(),i.getMonth()-o,1),n=new Date(i.getFullYear(),i.getMonth()-o-1,1);t.push({start:n.toISOString().split("T")[0],end:e.toISOString().split("T")[0]})}return t}();console.log(`fetching commits for ${o.length} date ranges (${m} months)`);for(const n of o){const o=T(e,t,n.start,n.end);o.length>0&&(i.push(...o),console.log(`${n.start}..${n.end}: ${o.length} commits (total: ${i.length})`)),Utilities.sleep(_)}return i.map((e=>({commitDate:e.commit.author.date,commitMessage:e.commit.message.split("\n")[0],commitId:e.html_url.split("commit/")[1],commitUrl:e.html_url,repository:e.repository.full_name,repositoryLink:`https://github.com/${e.repository.full_name}`,repositoryId:e.repository.id,repositoryName:e.repository.name,repositoryOwner:e.repository.owner.login,repositoryDescription:e.repository.description,isRepositoryPrivate:e.repository.private,isRepositoryFork:e.repository.fork})))}function A(e){const t={":art:":"ðŸŽ¨",":zap:":"âš¡ï¸",":fire:":"ðŸ”¥",":bug:":"ðŸ›",":ambulance:":"ðŸš‘ï¸",":sparkles:":"âœ¨",":memo:":"ðŸ“",":rocket:":"ðŸš€",":lipstick:":"ðŸ’„",":tada:":"ðŸŽ‰",":white_check_mark:":"âœ…",":lock:":"ðŸ”’ï¸",":closed_lock_with_key:":"ðŸ”",":bookmark:":"ðŸ”–",":rotating_light:":"ðŸš¨",":construction:":"ðŸš§",":green_heart:":"ðŸ’š",":arrow_down:":"â¬‡ï¸",":arrow_up:":"â¬†ï¸",":pushpin:":"ðŸ“Œ",":construction_worker:":"ðŸ‘·",":chart_with_upwards_trend:":"ðŸ“ˆ",":recycle:":"â™»ï¸",":heavy_plus_sign:":"âž•",":heavy_minus_sign:":"âž–",":wrench:":"ðŸ”§",":hammer:":"ðŸ”¨",":globe_with_meridians:":"ðŸŒ",":pencil2:":"âœï¸",":poop:":"ðŸ’©",":rewind:":"âªï¸",":twisted_rightwards_arrows:":"ðŸ”€",":package:":"ðŸ“¦ï¸",":alien:":"ðŸ‘½ï¸",":truck:":"ðŸšš",":page_facing_up:":"ðŸ“„",":boom:":"ðŸ’¥",":bento:":"ðŸ±",":wheelchair:":"â™¿ï¸",":bulb:":"ðŸ’¡",":beers:":"ðŸ»",":speech_balloon:":"ðŸ’¬",":card_file_box:":"ðŸ—ƒï¸",":loud_sound:":"ðŸ”Š",":mute:":"ðŸ”‡",":busts_in_silhouette:":"ðŸ‘¥",":children_crossing:":"ðŸš¸",":building_construction:":"ðŸ—ï¸",":iphone:":"ðŸ“±",":clown_face:":"ðŸ¤¡",":egg:":"ðŸ¥š",":see_no_evil:":"ðŸ™ˆ",":camera_flash:":"ðŸ“¸",":alembic:":"âš—ï¸",":mag:":"ðŸ”ï¸",":label:":"ðŸ·ï¸",":seedling:":"ðŸŒ±",":triangular_flag_on_post:":"ðŸš©",":goal_net:":"ðŸ¥…",":dizzy:":"ðŸ’«",":wastebasket:":"ðŸ—‘ï¸",":passport_control:":"ðŸ›‚",":adhesive_bandage:":"ðŸ©¹",":monocle_face:":"ðŸ§",":coffin:":"âš°ï¸",":test_tube:":"ðŸ§ª",":necktie:":"ðŸ‘”",":stethoscope:":"ðŸ©º",":bricks:":"ðŸ§±",":technologist:":"ðŸ§‘â€ðŸ’»",":money_with_wings:":"ðŸ’¸",":thread:":"ðŸ§µ",":safety_vest:":"ðŸ¦º"};let i=e;for(const[e,o]of Object.entries(t))i=i.replace(e,o);return i}const O=()=>{var e;return null!==(e=Calendar.CalendarList.list({showHidden:!0}).items)&&void 0!==e?e:[]},E=e=>O().find((t=>t.summary===e)),I=e=>{const t=Calendar;if(t.CalendarList.list({showHidden:!0}).items.filter((e=>"owner"===e.accessRole)).map((e=>e.summary)).includes(e))throw new Error(`calendar ${e} already exists!`);const i=t.newCalendar();i.summary=e,i.timeZone=t.Settings.get("timezone").value;return t.Calendars.insert(i)};function L(e){return O().find((t=>t.summary===e))}function U(e){const t=e.reduce(((e,t)=>{const i=function(e){const t=Calendar.Events.list(e.id,{maxResults:s}).items.map((e=>function(e){var t,i,o,n,s;return{id:e.id,summary:e.summary,description:null!==(t=e.description)&&void 0!==t?t:"",htmlLink:e.htmlLink,attendees:null!==(i=e.attendees)&&void 0!==i?i:[],reminders:null!==(o=e.reminders)&&void 0!==o?o:{},visibility:null!==(n=e.visibility)&&void 0!==n?n:"default",start:e.start,end:e.end,created:e.created,updated:e.updated,colorId:e.colorId,extendedProperties:null!==(s=e.extendedProperties)&&void 0!==s?s:{}}}(e)));return t}(L(t));return[...e,...i]}),[]);return t}function z(e,t){if(0===t.length)return[];const i=ScriptApp.getOAuthToken(),o=`https://www.googleapis.com/calendar/v3/calendars/${encodeURIComponent(e.id)}/events`,n=t.map((e=>({url:o,method:"post",contentType:"application/json",headers:{Authorization:`Bearer ${i}`},payload:JSON.stringify(e),muteHttpExceptions:!0})));return UrlFetchApp.fetchAll(n).map(((e,t)=>200===e.getResponseCode()?JSON.parse(e.getContentText()):(j.info(`failed to add event ${t}: ${e.getContentText()}`),null))).filter((e=>null!==e))}function H(e,t){Calendar.Events.remove(e.id,t.id)}function F(e){const t=[...e].sort().join(",");return Utilities.computeDigest(Utilities.DigestAlgorithm.MD5,t).map((e=>(e<0?e+256:e).toString(16).padStart(2,"0"))).join("")}function J(){C("github_commit_changes_count","0"),C("github_commits_tracked_to_be_added_hash",""),C("github_commits_tracked_to_be_deleted_hash","")}function B(e,t){return t.sort(((e,t)=>Number(new Date(t.commitDate))-Number(new Date(e.commitDate)))).filter((t=>t.repository.includes(e[y].username))).filter((t=>!1===e[y].commits_configs.ignored_repos.includes(t.repositoryName)))}function q(e){var t;j.info("syncing github commits");const i={githubCommits:G(e[y].username,e[y].personal_token),githubGcalCommits:U([e[y].commits_configs.commits_calendar])},o=x("github_commit_changes_count"),n=Number(o)+1;null===o&&J(),C("github_commit_changes_count",n.toString()),1===n?j.info(`checking commit changes: ${n}/${r}`):n>1&&n<r?j.info(`confirming commit changes: ${n}/${r}`):n===r&&j.info(`making commit changes if succeed: ${n}/${r}`);const s=B(e,i.githubCommits);j.info(`found ${s.length} commits after filtering`);const d=L(e[y].commits_configs.commits_calendar);j.info(`github calendar "${e[y].commits_configs.commits_calendar}" found: ${!!d}, id: ${null!==(t=null==d?void 0:d.id)&&void 0!==t?t:"N/A"}`);const m=Object.assign(Object.assign({},function({filteredRepos:e,currentGithubSyncIndex:t,githubCalendar:i,githubGcalCommits:o,parseCommitEmojis:n}){const s={commits_tracked_to_be_added:[],commits_added:[]};for(const t of e){if(!o.filter((e=>e.extendedProperties.private.repository===t.repository)).find((e=>e.extendedProperties.private.commitDate===t.commitDate&&A(e.extendedProperties.private.commitMessage)===A(t.commitMessage)))){const e=n?A(t.commitMessage):t.commitMessage,i={private:{commitMessage:e,commitDate:t.commitDate,repository:t.repository,repositoryName:t.repositoryName,repositoryLink:t.repositoryLink,commitId:t.commitId}},o={summary:`${t.repositoryName} - ${e}`,description:`repository: https://github.com/${t.repository}\ncommit: ${t.commitUrl}`,start:{dateTime:t.commitDate},end:{dateTime:t.commitDate},reminders:{useDefault:!1,overrides:[]},extendedProperties:i};s.commits_tracked_to_be_added.push(o)}}const d=s.commits_tracked_to_be_added.map((e=>e.extendedProperties.private.commitId)),m=F(d);if(1===t)return j.info(`storing hash for ${d.length} commits to track for addition`),C("github_commits_tracked_to_be_added_hash",m),s;const l=x("github_commits_tracked_to_be_added_hash");if(!l)return j.info("no stored hash found, resetting to step 1"),J(),C("github_commits_tracked_to_be_added_hash",m),s;if(j.info(`comparing hashes: stored=${l.slice(0,8)}... current=${m.slice(0,8)}...`),l!==m)return j.info("reset github commit properties due hash mismatch in added commits"),J(),s;if(t===r&&s.commits_tracked_to_be_added.length>0){const e=s.commits_tracked_to_be_added.length,t=Math.ceil(e/a);j.info(`adding ${e} commits to gcal in ${t} batches of ${a}`);for(let o=0;o<e;o+=a){const n=z(i,s.commits_tracked_to_be_added.slice(o,o+a));s.commits_added.push(...n),j.info(`batch ${Math.floor(o/a)+1}/${t}: added ${n.length} commits`),o+a<e&&Utilities.sleep(c)}J()}return s}({currentGithubSyncIndex:n,githubCalendar:d,githubGcalCommits:i.githubGcalCommits,filteredRepos:s,parseCommitEmojis:e[y].commits_configs.parse_commit_emojis})),function({githubGcalCommits:e,githubCalendar:t,currentGithubSyncIndex:i,filteredRepos:o}){const n={commits_deleted:[],commits_tracked_to_be_deleted:[]};e.forEach((e=>{const t=e.extendedProperties.private;o.filter((e=>e.repository===t.repository)).find((e=>e.commitDate===t.commitDate&&A(e.commitMessage)===A(t.commitMessage)))||n.commits_tracked_to_be_deleted.push(e)}));const s=n.commits_tracked_to_be_deleted.map((e=>e.extendedProperties.private.commitId)),a=F(s);if(1===i)return j.info(`storing hash for ${s.length} commits to track for deletion`),C("github_commits_tracked_to_be_deleted_hash",a),n;const c=x("github_commits_tracked_to_be_deleted_hash");if(!c)return j.info("no stored delete hash found, resetting to step 1"),J(),C("github_commits_tracked_to_be_deleted_hash",a),n;if(j.info(`comparing delete hashes: stored=${c.slice(0,8)}... current=${a.slice(0,8)}...`),c!==a)return j.info("reset github commit properties due hash mismatch in deleted commits"),J(),n;if(i===r&&n.commits_tracked_to_be_deleted.length>0){j.info(`deleting ${n.commits_tracked_to_be_deleted.length} commits on gcal`);for(let e=0;e<n.commits_tracked_to_be_deleted.length;e++){const i=n.commits_tracked_to_be_deleted[e];H(t,i),n.commits_deleted.push(i),e%50!=0&&e!==n.commits_tracked_to_be_deleted.length-1||j.info(`${e+1}/${n.commits_tracked_to_be_deleted.length} commits deleted from gcal`)}J()}return n}({currentGithubSyncIndex:n,githubCalendar:d,githubGcalCommits:i.githubGcalCommits,filteredRepos:s}));return 0===m.commits_tracked_to_be_added.length&&0===m.commits_tracked_to_be_deleted.length&&(j.info("reset github commit properties due found no commits tracked"),J()),m}function Z(e){return"object"==typeof e&&null!==e}function Y(e,t){if(!Z(e))return!1;for(const i in t){if(!(i in e))return j.error(`Missing key: ${i}`),!1;const o=typeof t[i],n=typeof e[i];if(Z(t[i])){if(!Z(e[i])||!Y(e[i],t[i]))return j.error(`Invalid nested structure or type mismatch at key: ${i}`),!1}else if(o!==n)return j.error(`Type mismatch at key: ${i}. Expected ${o}, found ${n}`),!1}return!0}function V(e,t){return Y(e,t)}const K={settings:{sync_function:"",skip_mode:!1,timezone_offset_correction:0,update_frequency:4,per_day_emails:{time_to_send:"15:00",email_new_gcal_sync_release:!1,email_daily_summary:!1},per_sync_emails:{email_errors:!1,email_session:!1}}},Q={username:"",commits_configs:{should_sync:!1,commits_calendar:"",ignored_repos:[],parse_commit_emojis:!1},personal_token:""};return class{constructor(t){if(this.extended_configs={timezone:"",timezone_offset:0,today_date:"",user_email:"",configs:{}},!function(e){if(!Z(e))return!1;const t={basic:!0,github:!0,githubIgnoredRepos:!0};if(t.basic=V(e,K),t.github=V(e[y],Q),"object"==typeof e[y]&&"ignored_repos"in e[y]&&Array.isArray(e[y].ignored_repos)){const i=e[y].ignored_repos.map((e=>"string"==typeof e));t.githubIgnoredRepos=i.every((e=>!0===e))}return Object.values(t).every((e=>!0===e))}(t))throw new Error(f);if("undefined"==typeof Calendar)throw new Error(b);const o=CalendarApp.getDefaultCalendar().getTimeZone();this.extended_configs.timezone=o,this.extended_configs.timezone_offset=function(e){const t=new Date,i=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds())),o=new Date(t.toLocaleString("en-US",{timeZone:e}));return(Number(o)-Number(i))/36e5}(o)+-1*t.settings.timezone_offset_correction;const n=function(e){const t=new Date,i=new Intl.DateTimeFormat("en-CA",{timeZone:e,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).formatToParts(t),o=e=>i.find((t=>t.type===e)).value;return`${o("year")}-${o("month")}-${o("day")}T${o("hour")}:${o("minute")}:${o("second")}.000`}(o);this.extended_configs.today_date=n.split("T")[0],this.extended_configs.user_email=Session.getActiveUser().getEmail(),this.extended_configs.configs=t,j.info(`${e} is running at version ${i}!`)}createMissingGASProperties(){const e=PropertiesService.getScriptProperties().getProperties();Object.keys(p).forEach((t=>{Object.keys(e).includes(t)||C(p[t],h[t])}))}createMissingGcalCalendars(){const{shouldSyncGithub:e}=S(this.extended_configs);(e=>{let t=!1;j.info(`checking calendars to create: ${JSON.stringify(e)}`),e.forEach((e=>{const i=E(e);j.info(`calendar "${e}" exists: ${!!i}`),i||(I(e),j.info(`created google calendar: [${e}]`),t=!0)})),t&&Utilities.sleep(2e3)})([...new Set([].concat(e?[this.extended_configs.configs[y].commits_configs.commits_calendar]:[]))])}handleError(i){if(this.extended_configs.configs.settings.per_sync_emails.email_errors){const o="string"==typeof i?i:i instanceof Error?i.message:JSON.stringify(i);D({to:this.extended_configs.user_email,name:`${e}`,subject:`an error occurred - ${e}`,htmlBody:`Hi!\n    <br/><br/>\n    an error recently occurred: <br/><br/>\n    <b>${o}</b>\n    <br /><br />\n    Regards,\n    your <a href='https://github.com/${t}'>${e}</a> bot\n  `})}else j.error(i)}getSessionLogs(){return j.logs}getGithubCommits(){const e=G(this.extended_configs.configs[y].username,this.extended_configs.configs[y].personal_token);return B(this.extended_configs.configs,e)}install(){var t,i;P(this.extended_configs.configs.settings.sync_function),t=this.extended_configs.configs.settings.sync_function,i=this.extended_configs.configs.settings.update_frequency,ScriptApp.newTrigger(t).timeBased().everyMinutes(i).create(),this.createMissingGASProperties(),j.info(`${e} was set to run function "${this.extended_configs.configs.settings.sync_function}" every ${this.extended_configs.configs.settings.update_frequency} minutes`)}uninstall(){P(this.extended_configs.configs.settings.sync_function),Object.keys(p).forEach((e=>{var t;t=p[e],PropertiesService.getScriptProperties().deleteProperty(t)})),j.info(`${e} automation was removed from appscript!`)}sync(){if(this.extended_configs.configs.settings.skip_mode)return j.info("skip_mode is set to true, skipping sync"),{};const{shouldSyncGithub:e}=S(this.extended_configs);if(!e)return j.info("nothing to sync"),{};this.createMissingGcalCalendars(),this.createMissingGASProperties();const t=Object.assign(Object.assign({},{commits_added:[],commits_deleted:[],commits_tracked_to_be_added:[],commits_tracked_to_be_deleted:[]}),e&&q(this.extended_configs.configs));return R(this.extended_configs,t)}}}));
