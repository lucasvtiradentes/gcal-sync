class GCal{getAllCalendars(e){const t=Calendar.CalendarList.list({showHidden:!0}).items;return e?t.map((e=>e.summary)):t}getAllOwnedCalendars(e){const t=this.getAllCalendars().filter((e=>"owner"===e.accessRole));return e?t.map((e=>e.summary)):t}getDefaultCalendar(){return this.getAllOwnedCalendars().find((e=>!0===e.primary))}getCalendarByName(e){return this.getAllCalendars().find((t=>t.summary===e))}getCalendarById(e){return this.getAllCalendars().find((t=>t.id===e))}createCalendar(e){if(this.getAllOwnedCalendars(!0).includes(e))throw new Error(`calendar ${e} already exists!`);let t=Calendar.newCalendar();t.summary=e,t.description="Created by GAS",t.timeZone=Calendar.Settings.get("timezone").value;const a=Calendar.Calendars.insert(t);return console.log(`Created the calendar ${a.summary}, with the ID ${a.id}`),a}getAllEventsFromCalendar(e,t){const a=Calendar.Events.list(e.id,{}).items;return t?this.parseEvents(a):a}getEventById(e,t){return this.getAllEventsFromCalendar(e).find((e=>e.id===t))}addEventToCalendar(e,t){const a={summary:t.summary??"",location:t.location??"",description:t.description??"",start:t.start,end:t.end,attendees:t.attendees?t.attendees.map((e=>({email:e}))):[],reminders:t.reminders.length>0?{useDefault:!1,overrides:t.reminders}:{useDefault:!0},extendedProperties:t.extendedProperties??{}},n=Calendar.Events.insert(a,e.id);return console.log(`event ${n.summary} was added to calendar ${e.summary}`),n}moveEventToOtherCalendar(e,t,a){Calendar.Events.move(e.id,t.id,a.id),console.log(`event ${t.summary} was moved!`)}deleteEventFromCalendar(e,t){Calendar.Events.remove(e.id,t.id),console.log(`event ${t.summary} was deleted!`)}updateEventFromCalendar(e,t,a){let n={...t,...a};console.log(n),Calendar.Events.update(n,e.id,t.id),console.log(`event ${t.summary} was updated!`)}parseEvents(e){return e.map((e=>this.parseEvent(e)))}parseEvent(e){return{id:e.id,summary:e.summary,description:e.description??"",link:e.htmlLink,attendees:e.attendees.length>0?e.attendees:[],visibility:e.visibility,dateStart:e.start,dateEnd:e.end,dateCreated:e.created,dateLastUpdated:e.updated,extendedProperties:e.extendedProperties??{}}}}this.GCal=GCal;