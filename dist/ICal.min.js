class ICal{constructor(e){this.calendars=e}#e(e,t,r){const n=e.slice(e.search(t)).replace(t,"");return n.slice(0,n.search(r))}#t(e){let t=[];const r=e.split("BEGIN:VEVENT\r\n").filter((e=>e.search("SUMMARY")>-1));for(let e of r){let r={dtstamp:this.#e(e,"DTSTAMP:","\r\n"),dtstart:this.#e(e,"DTSTART;VALUE=DATE:","\r\n"),name:this.#e(e,"SUMMARY:","\r\n"),id:this.#e(e,"UID:","\r\n"),description:this.#e(e,"DESCRIPTION:","\r\n"),sequence:this.#e(e,"SEQUENCE:","\r\n"),tzid:this.#e(e,"TZID:","\r\n")};t.push(r)}return t}getEventsFromIcsCalendar(e){let t="";const r=e.replace("webcal://","https://"),n=UrlFetchApp.fetch(r,{validateHttpsCertificates:!1,muteHttpExceptions:!0});if(200!=n.getResponseCode())throw new Error("Error: Encountered HTTP error "+n.getResponseCode()+" when accessing "+r);{let e=RegExp("(BEGIN:VCALENDAR.*?END:VCALENDAR)","s").exec(n.getContentText());if(null==e)throw new Error("[ERROR] Incorrect ics/ical URL: "+r);t=e[0]}return this.#t(t)}getEventsFromAllCalendars(){let e=[];for(let t of this.calendars){const r=this.getEventsFromIcsCalendar(t);e=e.concat(r)}return e}}this.ICal=ICal;